# üìä –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ—Å—Ä–µ–¥–Ω–∏—á–µ—Å–∫–æ–π –º–æ–¥–µ–ª–∏ –º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ Recraft.ai

**–î–∞—Ç–∞:** 25 —è–Ω–≤–∞—Ä—è 2025  
**–í–µ—Ä—Å–∏—è:** 2.0  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

---

## üìã –û–±–∑–æ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∏–∑ **—Å—Ç—Ä–æ–∫ 2 –∏ 3** —Ñ–∞–π–ª–∞ `toch.txt`:

### –°—Ç—Ä–æ–∫–∞ 2: –ü–æ—Å—Ä–µ–¥–Ω–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å (Middleman Model)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ —Ä–∞—Å—á–µ—Ç–∞ —Ü–µ–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç–∏ API + –Ω–∞—Ü–µ–Ω–∫–∞
- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –ú–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
- ‚úÖ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫—É—Ä—Å–∞ USD/RUB
- ‚úÖ –ü—Ä–æ–∑—Ä–∞—á–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è AI-–¥–≤–∏–∂–∫–∞–º–∏

### –°—Ç—Ä–æ–∫–∞ 3: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Recraft.ai
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –Ω–æ–≤—ã–π —Ç–∏–ø –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏: **–í–µ–∫—Ç–æ—Ä–Ω—ã–π –ö—Ä–µ–∞—Ç–∏–≤** (120‚ÇΩ)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –Ω–æ–≤—ã–π —Ç–∏–ø –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏: **–ë—Ä–µ–Ω–¥–æ–≤—ã–π –°–µ—Ç (Fusion)** (200‚ÇΩ)
- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ª–æ–≥–∏–∫–∞ Fusion-—Ü–µ–ø–æ—á–µ–∫ (–Ω–µ—Å–∫–æ–ª—å–∫–æ AI-–∞–≥–µ–Ω—Ç–æ–≤ –≤ –æ–¥–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏)

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. Backend Models (`backend/models.py`)

#### –ù–æ–≤—ã–µ –º–æ–¥–µ–ª–∏:

**`AiEngine`** - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ AI-–¥–≤–∏–∂–∫–∞–º–∏
```python
- name: str                          # –ù–∞–∑–≤–∞–Ω–∏–µ –¥–≤–∏–∂–∫–∞ (e.g., "Recraft.ai")
- description: Text                  # –û–ø–∏—Å–∞–Ω–∏–µ
- role: str                          # –†–æ–ª—å (e.g., "–í–µ–∫—Ç–æ—Ä–Ω–∞—è –≥—Ä–∞—Ñ–∏–∫–∞")
- api_endpoint: str                  # URL API (–∑–∞–≥–ª—É—à–∫–∞)
- api_key_encrypted: str             # API –∫–ª—é—á (–≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ —à–∏—Ñ—Ä–æ–≤–∞—Ç—å)
- internal_cost_usd_per_unit: float  # ‚≠ê –°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å –≤ USD
- markup_percentage: float           # ‚≠ê –ù–∞—Ü–µ–Ω–∫–∞ –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö (300% = x4)
- is_active: bool                    # –ê–∫—Ç–∏–≤–µ–Ω –ª–∏ –¥–≤–∏–∂–æ–∫
- generation_type: GenerationType    # –°–≤—è–∑—å —Å —Ç–∏–ø–æ–º –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
```

**`PricingConfiguration`** - –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ü–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
```python
- key: str                           # –ö–ª—é—á (e.g., "usd_to_rub_exchange_rate")
- value: float                       # ‚≠ê –ó–Ω–∞—á–µ–Ω–∏–µ (e.g., 100.0 –¥–ª—è –∫—É—Ä—Å–∞)
- description: str                   # –û–ø–∏—Å–∞–Ω–∏–µ
```

**`FusionChain`** - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Fusion-—Ü–µ–ø–æ—á–µ–∫
```python
- name: str                          # –ù–∞–∑–≤–∞–Ω–∏–µ (e.g., "–ë—Ä–µ–Ω–¥–æ–≤—ã–π –°–µ—Ç")
- generation_type: GenerationType    # BRANDED_SET
- chain_config: Text (JSON)          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ü–µ–ø–æ—á–∫–∏ AI-–∞–≥–µ–Ω—Ç–æ–≤
- total_cost_usd: float              # ‚≠ê –°—É–º–º–∞—Ä–Ω–∞—è —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å
- markup_percentage: float           # ‚≠ê –ù–∞—Ü–µ–Ω–∫–∞ –¥–ª—è –≤—Å–µ–π —Ü–µ–ø–æ—á–∫–∏
```

#### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ enum:
```python
class GenerationType(str, enum.Enum):
    # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ ...
    VECTOR_CREATIVE = "vector_creative"  # NEW: Recraft.ai
    BRANDED_SET = "branded_set"          # NEW: Fusion
```

---

### 2. Pricing Utility (`backend/pricing_utils.py`)

**–ö–ª—é—á–µ–≤–∞—è —Ñ–æ—Ä–º—É–ª–∞ —Ä–∞—Å—á–µ—Ç–∞:**
```
–§–∏–Ω–∞–ª—å–Ω–∞—è –¶–µ–Ω–∞ (‚ÇΩ) = (–°—Ç–æ–∏–º–æ—Å—Ç—å API –≤ USD √ó –ö—É—Ä—Å USD/RUB) √ó (1 + –ù–∞—Ü–µ–Ω–∫–∞ (%) / 100)
```

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- `get_exchange_rate(db)` - –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–∏–π –∫—É—Ä—Å USD/RUB
- `calculate_final_price(base_cost_usd, markup_percentage, exchange_rate)` - –†–∞—Å—á–µ—Ç —Ñ–∏–Ω–∞–ª—å–Ω–æ–π —Ü–µ–Ω—ã
- `get_generation_price(db, generation_type)` - –ü–æ–ª–Ω—ã–π —Ä–∞—Å—á–µ—Ç —Ü–µ–Ω—ã –¥–ª—è —Ç–∏–ø–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
- `calculate_margin_summary(db)` - –°–≤–æ–¥–∫–∞ –ø–æ –º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤

---

### 3. API Endpoints (`backend/routers/pricing_admin.py`)

**Prefix:** `/api/admin/pricing` (—Ç—Ä–µ–±—É–µ—Ç—Å—è `is_admin=True`)

#### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ AI-–¥–≤–∏–∂–∫–∞–º–∏:
- `GET /engines` - –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö AI-–¥–≤–∏–∂–∫–æ–≤
- `POST /engines` - –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –¥–≤–∏–∂–æ–∫
- `PATCH /engines/{engine_id}` - –û–±–Ω–æ–≤–∏—Ç—å –¥–≤–∏–∂–æ–∫ (—Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å, –Ω–∞—Ü–µ–Ω–∫—É)
- `DELETE /engines/{engine_id}` - –î–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –¥–≤–∏–∂–æ–∫

#### –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
- `GET /config` - –ü–æ–ª—É—á–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–∫—É—Ä—Å USD/RUB)
- `PATCH /config/{key}` - –û–±–Ω–æ–≤–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫—É (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç –≤—Å–µ —Ü–µ–Ω—ã!)

#### Fusion-—Ü–µ–ø–æ—á–∫–∏:
- `GET /fusion-chains` - –°–ø–∏—Å–æ–∫ Fusion-—Ü–µ–ø–æ—á–µ–∫
- `POST /fusion-chains` - –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é —Ü–µ–ø–æ—á–∫—É

#### –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –ú–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç–∏:
- `GET /margin-calculator` - –ü–æ–ª–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤
- `GET /margin-calculator/{generation_type}` - –†–∞—Å—á–µ—Ç –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–∏–ø–∞

---

### 4. –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (`backend/routers/generation.py`)

- ‚úÖ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ —Ü–µ–Ω –∏–∑ `pricing_utils` –≤–º–µ—Å—Ç–æ —Ö–∞—Ä–¥–∫–æ–¥–∞
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–æ–≤—ã—Ö —Ç–∏–ø–æ–≤: `VECTOR_CREATIVE`, `BRANDED_SET`
- ‚úÖ Endpoint `/api/generation/pricing/list` —Ç–µ–ø–µ—Ä—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Ü–µ–Ω—ã

**–ù–æ–≤—ã–µ —Ç–∏–ø—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (–º–æ–∫–∏):**

**–í–µ–∫—Ç–æ—Ä–Ω—ã–π –ö—Ä–µ–∞—Ç–∏–≤** (120‚ÇΩ):
```python
result = {
    "url": f"https://mock-storage.example.com/vector/{generation.id}.svg",
    "format": "SVG",
    "scalable": True,
    "message": "–í–µ–∫—Ç–æ—Ä–Ω—ã–π –∫—Ä–µ–∞—Ç–∏–≤ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω —á–µ—Ä–µ–∑ Recraft.ai"
}
```

**–ë—Ä–µ–Ω–¥–æ–≤—ã–π –°–µ—Ç** (200‚ÇΩ):
```python
result = {
    "url": f"https://mock-storage.example.com/branded-set/{generation.id}/",
    "creatives": [
        "creative_1.svg",
        "creative_2.svg",
        "creative_3.svg"
    ],
    "message": "–ë—Ä–µ–Ω–¥–æ–≤—ã–π –°–µ—Ç –∏–∑ 3 –∫—Ä–µ–∞—Ç–∏–≤–æ–≤ –≤ –µ–¥–∏–Ω–æ–º —Å—Ç–∏–ª–µ"
}
```

---

## üé® Frontend –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –ú–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ (`frontend/app/admin/pricing/page.tsx`)

**URL:** `/admin/pricing`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
- üìä –¢–∞–±–ª–∏—Ü–∞ –º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
  - –°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å (USD)
  - –°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å (‚ÇΩ)
  - –ù–∞—Ü–µ–Ω–∫–∞ (%)
  - –§–∏–Ω–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞
  - –ü—Ä–∏–±—ã–ª—å –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã (‚ÇΩ –∏ %)
- ‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—É—Ä—Å–æ–º USD/RUB
- ü§ñ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ AI-–¥–≤–∏–∂–∫–∞–º–∏ (–∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∏ –Ω–∞—Ü–µ–Ω–∫–∏)
- üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ—Å—á–µ—Ç —Ü–µ–Ω –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö

### 2. –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (`frontend/app/generate/page.tsx`)

- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –∫–∞—Ä—Ç–æ—á–∫–∏ –¥–ª—è –Ω–æ–≤—ã—Ö —Ç–∏–ø–æ–≤ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:
  - **–í–µ–∫—Ç–æ—Ä–Ω—ã–π –∫—Ä–µ–∞—Ç–∏–≤** —Å badge "NEW"
  - **–ë—Ä–µ–Ω–¥–æ–≤—ã–π –°–µ—Ç** —Å badge "NEW" –∏ "Premium"
- ‚úÖ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ü–µ–Ω –∏–∑ API
- ‚úÖ –ò–Ω–¥–∏–∫–∞—Ü–∏—è –ø—Ä–µ–º–∏—É–º-—Ñ—É–Ω–∫—Ü–∏–π

---

## üíæ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### Alembic –º–∏–≥—Ä–∞—Ü–∏—è (`backend/alembic/versions/20250125_add_pricing_models.py`)

**–ù–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã:**
1. `pricing_configuration` - –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–∫—É—Ä—Å USD/RUB)
2. `ai_engines` - AI-–¥–≤–∏–∂–∫–∏ —Å —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å—é –∏ –Ω–∞—Ü–µ–Ω–∫–æ–π
3. `fusion_chains` - Fusion-—Ü–µ–ø–æ—á–∫–∏

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏:**
```bash
cd backend
alembic upgrade head
```

### Seed –¥–∞–Ω–Ω—ã–µ (`backend/init_db.py`)

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è:**

**1. –ö—É—Ä—Å USD/RUB:**
- `usd_to_rub_exchange_rate = 100.0` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

**2. AI-–î–≤–∏–∂–∫–∏ (7 —à—Ç.):**
| –î–≤–∏–∂–æ–∫ | –¢–∏–ø | –°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å (USD) | –ù–∞—Ü–µ–Ω–∫–∞ (%) | –§–∏–Ω–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ (‚ÇΩ) |
|--------|-----|---------------------|-------------|--------------------|
| Recraft.ai | VECTOR_CREATIVE | $0.30 | 300% | 120‚ÇΩ |
| DALL-E 3 | STATIC_IMAGE | $0.20 | 400% | 100‚ÇΩ |
| Stable Diffusion XL | STATIC_IMAGE | $0.05 | 1900% | 100‚ÇΩ |
| RunwayML Gen-2 | ANIMATED_IMAGE | $0.50 | 400% | 250‚ÇΩ |
| Pika Labs | VIDEO_MORPH | $0.80 | 400% | 400‚ÇΩ |
| GPT-4 Vision | CONTEXTUAL_PHOTO | $0.30 | 400% | 150‚ÇΩ |
| GPT-4 Scoring | AI_SCORING | $0.04 | 400% | 20‚ÇΩ |

**3. Fusion-—Ü–µ–ø–æ—á–∫–∏:**
- **–ë—Ä–µ–Ω–¥–æ–≤—ã–π –°–µ—Ç**: Recraft.ai ‚Üí Brand Colors ‚Üí Consistency Check
  - –°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å: $0.40
  - –ù–∞—Ü–µ–Ω–∫–∞: 400%
  - –§–∏–Ω–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞: **200‚ÇΩ**

---

## üìà –ë–∏–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫–∏

### –ü—Ä–∏–º–µ—Ä —Ä–∞—Å—á–µ—Ç–∞ –º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

**–í–µ–∫—Ç–æ—Ä–Ω—ã–π –∫—Ä–µ–∞—Ç–∏–≤ (Recraft.ai):**
```
–°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å API:    $0.30
–ö—É—Ä—Å USD/RUB:         100.0
–°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å (‚ÇΩ):    30‚ÇΩ
–ù–∞—Ü–µ–Ω–∫–∞:              300% (x4)
–§–∏–Ω–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞:       120‚ÇΩ
–ü—Ä–∏–±—ã–ª—å –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã:    90‚ÇΩ
ROI:                  300%
```

**–°—Ç–∞—Ç–∏—á–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (DALL-E 3 vs Stable Diffusion):**

| –î–≤–∏–∂–æ–∫ | –°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å | –ù–∞—Ü–µ–Ω–∫–∞ | –¶–µ–Ω–∞ | –ü—Ä–∏–±—ã–ª—å | ROI |
|--------|---------------|---------|------|---------|-----|
| DALL-E 3 | $0.20 (20‚ÇΩ) | 400% | 100‚ÇΩ | 80‚ÇΩ | 400% |
| SD XL | $0.05 (5‚ÇΩ) | 1900% | 100‚ÇΩ | 95‚ÇΩ | 1900% |

> **–ò–Ω—Å–∞–π—Ç:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–æ–ª–µ–µ –¥–µ—à–µ–≤—ã—Ö API –ø—Ä–∏ —Ç–æ–π –∂–µ —Ü–µ–Ω–µ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞ = –≤—ã—à–µ –ø—Ä–∏–±—ã–ª—å!

---

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä:

1. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –ú–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç–∏:**
   ```
   http://localhost:3002/admin/pricing
   ```

2. **–ò–∑–º–µ–Ω–∏—Ç–µ –∫—É—Ä—Å USD/RUB:**
   - –í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—ã–π –∫—É—Ä—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä, 95 –≤–º–µ—Å—Ç–æ 100)
   - –ù–∞–∂–º–∏—Ç–µ "–û–±–Ω–æ–≤–∏—Ç—å –∫—É—Ä—Å"
   - –í—Å–µ —Ü–µ–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Å—á–∏—Ç–∞—é—Ç—Å—è!

3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –Ω–∞—Ü–µ–Ω–∫—É –¥–ª—è –¥–≤–∏–∂–∫–∞:**
   - –ù–∞–π–¥–∏—Ç–µ –Ω—É–∂–Ω—ã–π AI-–¥–≤–∏–∂–æ–∫
   - –ò–∑–º–µ–Ω–∏—Ç–µ "–°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å API (USD)" –∏–ª–∏ "–ù–∞—Ü–µ–Ω–∫–∞ (%)"
   - –¶–µ–Ω—ã –æ–±–Ω–æ–≤—è—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

4. **–ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Å–≤–æ–¥–∫—É –ø–æ –ø—Ä–∏–±—ã–ª–∏:**
   - –¢–∞–±–ª–∏—Ü–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∏–±—ã–ª—å (‚ÇΩ) –∏ ROI (%) –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:

1. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:**
   ```
   http://localhost:3002/generate
   ```

2. **–í—ã–±–µ—Ä–∏—Ç–µ –Ω–æ–≤—ã–π —Ç–∏–ø:**
   - "–í–µ–∫—Ç–æ—Ä–Ω—ã–π –∫—Ä–µ–∞—Ç–∏–≤" (120‚ÇΩ) - –¥–ª—è –ª–æ–≥–æ—Ç–∏–ø–æ–≤ –∏ –∏–∫–æ–Ω–æ–∫
   - "–ë—Ä–µ–Ω–¥–æ–≤—ã–π –°–µ—Ç" (200‚ÇΩ) - –¥–ª—è –∫–æ–º–ø–ª–µ–∫—Ç–∞ –∫—Ä–µ–∞—Ç–∏–≤–æ–≤ –≤ –µ–¥–∏–Ω–æ–º —Å—Ç–∏–ª–µ

3. **–°–æ–∑–¥–∞–π—Ç–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é:**
   - –í–≤–µ–¥–∏—Ç–µ –ø—Ä–æ–º–ø—Ç
   - –ü–æ–ª—É—á–∏—Ç–µ SVG-—Ñ–∞–π–ª –∏–ª–∏ –Ω–∞–±–æ—Ä –∏–∑ 3 –∫—Ä–µ–∞—Ç–∏–≤–æ–≤

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Recraft.ai

### –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (Mock):
```python
# backend/routers/generation.py
elif gen_request.type == GenerationType.VECTOR_CREATIVE:
    result = {
        "url": f"https://mock-storage.example.com/vector/{generation.id}.svg",
        "format": "SVG",
        "scalable": True,
        "message": "–í–µ–∫—Ç–æ—Ä–Ω—ã–π –∫—Ä–µ–∞—Ç–∏–≤ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω —á–µ—Ä–µ–∑ Recraft.ai"
    }
```

### –ü—Ä–æ–¥–∞–∫—à–Ω-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (TODO):
```python
import httpx

async def generate_with_recraft(prompt: str, api_key: str):
    async with httpx.AsyncClient() as client:
        response = await client.post(
            "https://api.recraft.ai/v1/generate",
            headers={"Authorization": f"Bearer {api_key}"},
            json={
                "prompt": prompt,
                "format": "svg",
                "style": "vector"
            }
        )
        return response.json()
```

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Recraft.ai:** https://recraft.ai/docs

---

## üìä API –ø—Ä–∏–º–µ—Ä—ã

### –ü–æ–ª—É—á–∏—Ç—å —Ä–∞—Å—á–µ—Ç –º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

**Request:**
```http
GET /api/admin/pricing/margin-calculator
Authorization: Bearer <admin_token>
```

**Response:**
```json
[
  {
    "generation_type": "vector_creative",
    "base_cost_usd": 0.30,
    "exchange_rate": 100.0,
    "cost_rub": 30.0,
    "markup_percentage": 300.0,
    "final_price_rub": 120,
    "profit_rub": 90.0,
    "profit_percentage": 75.0
  },
  // ... –¥—Ä—É–≥–∏–µ —Ç–∏–ø—ã ...
]
```

### –û–±–Ω–æ–≤–∏—Ç—å –∫—É—Ä—Å USD/RUB

**Request:**
```http
PATCH /api/admin/pricing/config/usd_to_rub_exchange_rate
Authorization: Bearer <admin_token>
Content-Type: application/json

{
  "value": 95.0
}
```

**Response:**
```json
{
  "id": 1,
  "key": "usd_to_rub_exchange_rate",
  "value": 95.0,
  "description": "–ö—É—Ä—Å –æ–±–º–µ–Ω–∞ USD/RUB",
  "updated_at": "2025-01-25T12:00:00"
}
```

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –í—Å–µ —Ü–µ–Ω—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Å—á–∏—Ç–∞—é—Ç—Å—è!

---

## ‚úÖ Checklist —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

- [x] **Backend Models:**
  - [x] `AiEngine` —Å `internal_cost_usd_per_unit` –∏ `markup_percentage`
  - [x] `PricingConfiguration` —Å `usd_to_rub_exchange_rate`
  - [x] `FusionChain` –¥–ª—è –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã—Ö –≥–µ–Ω–µ—Ä–∞—Ü–∏–π
  - [x] –ù–æ–≤—ã–µ `GenerationType`: `VECTOR_CREATIVE`, `BRANDED_SET`

- [x] **Backend Logic:**
  - [x] `pricing_utils.py` —Å —Ñ–æ—Ä–º—É–ª–æ–π —Ä–∞—Å—á–µ—Ç–∞ —Ü–µ–Ω
  - [x] API endpoints –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–≤–∏–∂–∫–∞–º–∏ –∏ —Ü–µ–Ω–∞–º–∏
  - [x] –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —Å–ø–∏—Å–∞–Ω–∏–µ –∫—Ä–µ–¥–∏—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–∞—Å—á–µ—Ç–∞
  - [x] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Recraft.ai –∏ –ë—Ä–µ–Ω–¥–æ–≤–æ–≥–æ –°–µ—Ç–∞ (mock)

- [x] **Frontend:**
  - [x] –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –ú–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
  - [x] –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ AI-–¥–≤–∏–∂–∫–∞–º–∏
  - [x] –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—É—Ä—Å–æ–º USD/RUB
  - [x] –ù–æ–≤—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å badge "NEW"

- [x] **Database:**
  - [x] Alembic –º–∏–≥—Ä–∞—Ü–∏—è –¥–ª—è –Ω–æ–≤—ã—Ö —Ç–∞–±–ª–∏—Ü
  - [x] Seed –¥–∞–Ω–Ω—ã–µ –¥–ª—è Recraft.ai
  - [x] Seed –¥–∞–Ω–Ω—ã–µ –¥–ª—è Fusion-—Ü–µ–ø–æ—á–µ–∫

- [x] **Documentation:**
  - [x] –ü–æ–ª–Ω–∞—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
  - [x] API –ø—Ä–∏–º–µ—Ä—ã
  - [x] –ë–∏–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫–∏

---

## üéØ –¶–µ–Ω–Ω–æ—Å—Ç—å –¥–ª—è –±–∏–∑–Ω–µ—Å–∞

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø–æ—Å—Ä–µ–¥–Ω–∏—á–µ—Å–∫–æ–π –º–æ–¥–µ–ª–∏:

1. **–ü—Ä–æ–∑—Ä–∞—á–Ω–∞—è –º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
   - –í–∏–¥–Ω–æ –ø—Ä–∏–±—ã–ª—å (‚ÇΩ) –∏ ROI (%) –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
   - –õ–µ–≥–∫–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –Ω–∞—Ü–µ–Ω–∫–∏

2. **–ì–∏–±–∫–æ–µ —Ü–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ:**
   - –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫—É—Ä—Å–∞ USD/RUB ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ—Å—á–µ—Ç –≤—Å–µ—Ö —Ü–µ–Ω
   - –ú–æ–∂–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ –Ω–∞—Ü–µ–Ω–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –¥–≤–∏–∂–∫–æ–≤

3. **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å:**
   - –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ AI-–¥–≤–∏–∂–∫–∏
   - –ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –¥–µ—à–µ–≤—ã—Ö API

4. **Recraft.ai:**
   - –ù–æ–≤–∞—è –Ω–∏—à–∞: –≤–µ–∫—Ç–æ—Ä–Ω–∞—è –≥—Ä–∞—Ñ–∏–∫–∞ –¥–ª—è –±—Ä–µ–Ω–¥–∏–Ω–≥–∞
   - –ü—Ä–µ–º–∏—É–º-—Å–µ–≥–º–µ–Ω—Ç —Å –≤—ã—Å–æ–∫–æ–π –º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é
   - –ë—Ä–µ–Ω–¥–æ–≤—ã–µ –°–µ—Ç—ã ‚Üí —Å—Ç–∏–º—É–ª –¥–ª—è –ø–æ–¥–ø–∏—Å–∫–∏

---

## üîÆ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ API:**
   - Recraft.ai (–≤–µ–∫—Ç–æ—Ä–Ω–∞—è –≥—Ä–∞—Ñ–∏–∫–∞)
   - DALL-E 3, Stable Diffusion (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è)
   - RunwayML, Pika Labs (–≤–∏–¥–µ–æ)

2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—É—Ä—Å–∞ USD/RUB:**
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¶–ë –†–§ API
   - Scheduled task –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

3. **AI Fusion Constructor:**
   - UI –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è custom Fusion-—Ü–µ–ø–æ—á–µ–∫
   - –í–∏–∑—É–∞–ª—å–Ω—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∞–≥–µ–Ω—Ç–æ–≤

4. **A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–≤–∏–∂–∫–æ–≤:**
   - –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ DALL-E vs Stable Diffusion
   - –í—ã–±–æ—Ä –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –¥–≤–∏–∂–∫–∞ –ø–æ –º–µ—Ç—Ä–∏–∫–∞–º

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –≤–æ–ø—Ä–æ—Å–æ–≤:
- Backend API: http://localhost:8001/docs
- Frontend: http://localhost:3002
- –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å: http://localhost:3002/admin/pricing

**–¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ:**
- Admin: `username=admin`, `password=admin123`
- User: `username=testuser`, `password=test123`

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 25 —è–Ω–≤–∞—Ä—è 2025  
**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 2.0  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ production

